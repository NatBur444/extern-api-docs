.. _Docflows: http://extern-api.testkontur.ru/swagger/ui/index#/Docflows
.. _`POST SignReplyDocumentAsync`: http://extern-api.testkontur.ru/swagger/ui/index#/Docflows/DocflowReplyDocument_SignReplyDocumentAsync
.. _`POST SignConfirmReplyDocumentAsync`: http://extern-api.testkontur.ru/swagger/ui/index#/Docflows/DocflowReplyDocument_SignConfirmReplyDocumentAsync
.. _`POST DecryptDocumentAsync`: http://extern-api.testkontur.ru/swagger/ui/index#/Docflows/Docflows_DecryptDocumentAsync
.. _`POST DecryptDocumentConfirmationAsync`: http://extern-api.testkontur.ru/swagger/ui/index#/Docflows/Docflows_DecryptDocumentConfirmationAsync

Методы для работы в документооборотах
=====================================

.. important:: Методы данного раздела позволяют работать только с облачными сертификатами электронной подписи, выпущенными Удостоверяющим центром АО "ПФ "СКБ Контур" (https://ca.kontur.ru).

В случае использования облачной криптографии в части работы с документооборотами появляется возможность проводить **подписание** и **расшифровку** документов, возникающих в ходе документооборота, на серверах Контур.Экстерна, то есть без необходимости установки криптопровайдеров и ключей сертификатов электронной подписи на рабочие места пользователей.

.. image:: /cloud.jpg

* в запросе передаются документы, которые необходимо подписать или расшифровать,
* в ответ возвращается идентификатор запроса, отправляется смс-сообщением с кодом,
* полученный код передается в запросе на подтверждение операции,
* расшифрованный контент документа сохраняется в документообороте / добавляется подпись под ответный документ

Подробная спецификация методов показана в сваггере в разделе Docflows_.

Список доступных методов:

* `Подпись ответного документа`_
* `Подтверждение подписи ответного документа`_
* `Дешифрование документа`_
* `Подтверждение дешифрования документа`_

Подпись ответного документа
---------------------------
Метод: `POST SignReplyDocumentAsync`_

Позволяет подписать сгенерированный ответный документ. 

.. important:: Для подписи извещений о получении на документы от ФНС или Росстата допускается указывать параметр ``forceConfirmation=true``, тогда подписание документа произойдет сразу, без необходимости подтверждения кодом из смс-сообщения. В этом случае смс-сообщение также не отправляется.

Подтверждение подписи ответного документа
-----------------------------------------
Метод: `POST SignConfirmReplyDocumentAsync`_

После ввода кода, полученного в смс-сообщении, произойдет подписание документа. Подпись добавится под ответный документ

Дешифрование документа
----------------------
Метод: `POST DecryptDocumentAsync`_

С помощью данного метода можно расшифровать любой зашифрованный документ в документообороте. 

Подтверждение дешифрования документа
------------------------------------
Метод: `POST DecryptDocumentConfirmationAsync`_

После ввода кода, полученного в смс-сообщении, произойдет дешифрование документа. Расшифрованный контент документа добавится в документооборот.
