.. _`3 причины`: https://normativ.kontur.ru/document?moduleId=1&documentId=191490
.. _`xsd-схеме`: https://normativ.kontur.ru/document?moduleId=1&documentId=191882&rangeId=377678

Проверка требования
===================

Согласно :ref:`порядку документооборота<rst-markup-demand-status>` в ответ на требование из ФНС налогоплательщик должен отправить извещение о получении, после которого сформировать квитанцию о приеме или уведомление об отказе. При этом существует только `3 причины`_, по которым можно отправить отказ от приема требования:

1. ошибочное направление налогоплательщику,
2. несоответствие утвержденному формату,
3. отсутствие (несоответствие) электронной подписи уполномоченного должностного лица налогового органа.

В файле отказа указывается перечень выявленных нарушений и коды ошибок.

При получении уведомления об отказе в приеме налоговый орган устраняет указанные в этом уведомлении ошибки и повторяет процедуру направления Требования о представлении документов.

Сценарий при работе с требованием
---------------------------------

1. Получить требование. 
2. Отправить извещение о получении. :doc:`<см. Методы для работы с ответными документами/dc/ответный документ>`.
3. Проверить требование на валидность. Метод :ref:`POST Check-Demand<rst-markup-check-demand>`.
4. Если требование корректное — отправить квитанцию о приеме fns534-demand-acceptance-result-positive. Следующим шагом, в зависимости от вида требования, :doc:`отправить ответ на него</inventories/index>`, уплатить штраф или явиться в налоговую. 
5. Если требование некорректное — отправить уведомление об отказе fns534-demand-acceptance-result-negative. В файле необходимо указать причину и код ошибки. На данном этапе работа с требованием завершена.

Причины отказа и коды ошибок
----------------------------

.. |br| raw:: html

       <br />

.. table::

    +--------------------------+----------------------------------+------------------------------------------+
    | Проверка                 | Перечень выявленных нарушений    | Реализация проверки                      |
    +==========================+==================================+==========================================+
    | Ошибочное |br|           | ИНН/КПП налогоплательщика |br|   | Сравнение ИНН/КПП в документе |br|       |
    | направление |br|         | не соответствует ИНН/КПП  |br|   | fns534-demand с организациями |br|       |
    | налогоплательщику        | в отправленном |br|              | пользователя                             |
    |                          | транспортном контейнере          |                                          |
    +--------------------------+----------------------------------+------------------------------------------+
    | Соответствие  |br|       | Файл не соответствует |br|       | Проверка Документа |br|                  |
    | утвержденному формату    | xsd-схеме                        | fns534-demand по `xsd-схеме`_            |
    |                          +----------------------------------+------------------------------------------+
    |                          | Нарушено условие |br|            | Проверка присутствия/отсутствия |br|     |
    |                          | присутствия (отсутствия)         | приложений fns534-demand-attachment |br| |
    |                          | элемента                         | к требованию.                            |
    |                          |                                  |                                          |
    |                          |                                  | Количество приложений, указанных в |br|  |
    |                          |                                  | документе fns534-demand,  |br|           |
    |                          |                                  | должно совпадать с фактическим |br|      |
    |                          |                                  | числом поступивших Приложений |br|       |
    |                          |                                  | fns534-demand-attachment                 |
    +--------------------------+----------------------------------+------------------------------------------+
    | Расшифровываемость  |br| | Контейнер зашифрован |br|        | Проверка реализуется на стороне |br|     |
    | и соответствие ЭП        | для другого получателя           | пользователя или интегратора.  |br|      |
    |                          |                                  | При формировании уведомления |br|        |
    |                          |                                  | об отказе есть возможность указать |br|  |
    |                          |                                  | соответствующий код ошибки               |
    |                          |                                  |                                          |
    |                          +----------------------------------+------------------------------------------+
    |                          | ЭП не соответствует |br|         |                                          |
    |                          | подписанному документу |br|      |                                          |
    |                          | (ЭП искажена или в документ |br| |                                          |
    |                          | были внесены изменения |br|      |                                          |
    |                          | уже после его подписания)        |                                          |
    +--------------------------+----------------------------------+------------------------------------------+