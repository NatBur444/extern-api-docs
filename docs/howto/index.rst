.. _`аутентификацию`: https://docs-ke.readthedocs.io/ru/latest/auth/index.html
.. _`swagger`: https://developer.testkontur.ru/#/extern
.. _`SDK`: https://github.com/skbkontur/extern-java-sdk/
.. _`ExternTestTools`: https://developer.testkontur.ru/extern.test.tools

Начало работы с API Контур.Экстерна
===================================

.. toctree::
   :maxdepth: 2
   :hidden:

   stepbystep
   howtodrafts

Для начала работы с API
-----------------------

* Получите :doc:`/manuals/api-key`.
* Заключите договор с Контуром. 
* Пройдите `аутентификацию`_ и получите auth.sid. 
* Для криптографических операций необходимо иметь электронную подпись. В API Контур.Экстерна помимо подписи на носителе поддерживается :ref:`технология DSS<rst-markup-сloud_dss>`. 

Что нужно знать об API
----------------------

**Возвращаемые значения** — json, кроме сервиса контентов. Даже если в методе возвращаются байты, то они вернутся в виде Json-строки. Внутри строки контент возвращается в формате base64. Напротив, **принимаемые значения** контентов ожидаются как application/octet-stream. 

**Работа с методами.** Все доступные методы можно смотреть через `swagger`_. Это упрощает создание http клиентов для вашего языка программирования. Если хотите отправлять запросы через Postman, то вы можете скачать JSON файл swagger’a и импортировать его в Postman.

Для Java есть официальный `SDK`_.

Для **генерации тестовых данных** мы разработали сервис `ExternTestTools`_, который позволяет сгенерировать данные пользователя, а также примеры отчетов в ФНС.

**Тестовая площадка**: "https://extern-api.testkontur.ru/".

На тестовой площадке есть свой набор инспекций (роботов), к которым стоит обращаться. Они отличаются стратегией обработки документооборотов. При работе с отчетностью в ФНС используйте следующие коды инспекций:

    * 0087 — Принимает все документы.
    * 0088 — Что бы вы ему не прислали — не примет.

Сценарии работы с API
---------------------

Порядок работы с методами зависит от цели и задач, которые вы решаете. Выделим основные три направления в работе с API Контур.Экстерна:

- отправка отчетности в контролирующие органы,
- мониторинг документооборотов,
- представление ответа на требования ИФНС.

Все перечисленные сценарии описаны в виде алгоритма действий с примерами вызова методов. 